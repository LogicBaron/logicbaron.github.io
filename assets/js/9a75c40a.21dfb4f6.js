"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9761],{3732:(s,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>m,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>h});const l=JSON.parse('{"id":"practice/efficienttrain/MOE/moe1","title":"Sparsely-Gated MOE Layer","description":"Mixture of Experts \ub97c \uc815\ub9ac\ud558\ub294 \uccab \ubc88\uc9f8 \uae00\uc774\ub2e4. \uccab \ubc88\uc9f8 \uae00\uc744 \uaf64 \uace0\ubbfc\ud588\ub294\ub370, Transformer \uc774\uc804 \ub17c\ubb38 \uc911 \uac00\uc7a5 \uc758\ubbf8\uc788\ub2e4\uace0 \uc0dd\uac01\ub418\ub294 \ub17c\ubb38\uc774\ub2e4.","source":"@site/docs/practice/efficienttrain/MOE/moe1.md","sourceDirName":"practice/efficienttrain/MOE","slug":"/practice/efficienttrain/MOE/moe1","permalink":"/docs/practice/efficienttrain/MOE/moe1","draft":false,"unlisted":false,"editUrl":"https://github.com/logicbaron/logicbaron.github.io/tree/dev/docs/practice/efficienttrain/MOE/moe1.md","tags":[{"inline":true,"label":"MOE","permalink":"/docs/tags/moe"},{"inline":true,"label":"LSTM","permalink":"/docs/tags/lstm"}],"version":"current","sidebarPosition":0,"frontMatter":{"title":"Sparsely-Gated MOE Layer","sidebar_position":0,"tags":["MOE","LSTM"]},"sidebar":"EfficienttrainSidebar","previous":{"title":"ZERO INFINITY","permalink":"/docs/practice/efficienttrain/zero_infinity"},"next":{"title":"Adaptive Attention Span in Transformer","permalink":"/docs/practice/efficienttrain/MOE/moe2"}}');var n=a(4848),i=a(8453);const t=a.p+"assets/images/moe1_structure-e7cc6910c3f58dcf084f28887304a5c1.png",r={title:"Sparsely-Gated MOE Layer",sidebar_position:0,tags:["MOE","LSTM"]},m="The Sparsely-Gated Mixture-Of-Experts Layer.",c={},h=[{value:"Novelty",id:"novelty",level:2},{value:"Structure",id:"structure",level:2},{value:"Gating Networks",id:"gating-networks",level:2},{value:"Engineering",id:"engineering",level:2}];function x(s){const e={a:"a",annotation:"annotation",h1:"h1",h2:"h2",header:"header",li:"li",math:"math",mi:"mi",mo:"mo",mrow:"mrow",mstyle:"mstyle",msub:"msub",mtable:"mtable",mtd:"mtd",mtext:"mtext",mtr:"mtr",ol:"ol",p:"p",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...s.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.header,{children:(0,n.jsx)(e.h1,{id:"the-sparsely-gated-mixture-of-experts-layer",children:"The Sparsely-Gated Mixture-Of-Experts Layer."})}),"\n",(0,n.jsx)(e.p,{children:"Mixture of Experts \ub97c \uc815\ub9ac\ud558\ub294 \uccab \ubc88\uc9f8 \uae00\uc774\ub2e4. \uccab \ubc88\uc9f8 \uae00\uc744 \uaf64 \uace0\ubbfc\ud588\ub294\ub370, Transformer \uc774\uc804 \ub17c\ubb38 \uc911 \uac00\uc7a5 \uc758\ubbf8\uc788\ub2e4\uace0 \uc0dd\uac01\ub418\ub294 \ub17c\ubb38\uc774\ub2e4."}),"\n",(0,n.jsx)(e.p,{children:'\uac1c\uc778\uc801\uc73c\ub85c, Transformer \uc774\uc804\uacfc \uc774\ud6c4\uc758 MOE \ubaa8\ub378\uc740 \uacb0\uacfc\ub294 \ub2e4\ub974\ub354\ub77c\ub3c4, \ubc29\ud5a5\uc131\uacfc \uc778\uc0ac\uc774\ud2b8\ub294 \uc0c1\ub2f9\ud788 \ub2e4\ub974\ub2e4. Transformer \uc774\uc804  MOE \ub17c\ubb38\ub4e4\uc740 "\uc131\ub2a5" \uac1c\uc120\uc744 \ud6e8\uc52c \uac15\uc870\ud558\ub294 \ubc18\uba74 Transformer \uc774\ud6c4 \ub17c\ubb38\ub4e4\uc740 \ubaa8\ub378\uc758 "\ud6a8\uc728" \uac1c\uc120\uc744 \uc911\uc810\uc5d0 \ub450\uace0 \uc788\ub2e4. Transformer \uc774\ud6c4\uc758 MOE \ub294 \uc774\ud6c4\uc758 \uae00\uc5d0\uc11c \uc815\ub9ac\ud558\uace0, \uc774 \uae00\uc5d0\uc11c\ub294 "\uc131\ub2a5" \uc704\uc8fc MOE \ub17c\ubb38\uc744 \ud558\ub098 \uc815\ub9ac\ud574\ub450\uace0 \uc9c0\ub098\uac00\ub824 \ud55c\ub2e4.'}),"\n",(0,n.jsx)(e.h2,{id:"novelty",children:"Novelty"}),"\n",(0,n.jsx)(e.p,{children:"\ub525 \ubaa8\ub378 \ub0b4 \uc77c\ubd80\ubd84\uc758 mixture of experts \ub97c \uc0ac\uc6a9\ud558\ub294 \uac83\uc744 \uc81c\uc548\ud558\ub294 \ub17c\ubb38. \uc2e4\uc9c8\uc801\uc778 gating network \uc758 \ud65c\uc6a9\uacfc, multiple gate of networks \uc758 \uac1c\ub150\uc744 \ub3c4\uc785. \ubcf8 \ub17c\ubb38 \uc774\uc804\uc758 MOE \ub294 \ub300\ubd80\ubd84 \uacfc\uc81c\uc5d0 \ub530\ub77c Experts Model \uc804\uccb4\ub97c \ud559\uc2b5\uc2dc\ud0a4\ub294 \ubc29\uc2dd\uc774\uc5c8\ub2e4."}),"\n",(0,n.jsx)(e.p,{children:"\ub2e8\uc21c\ud788 \ubc29\uc2dd\uc758 \uc801\uc6a9\ubfd0\ub9cc \uc544\ub2c8\ub77c, \ud574\ub2f9 \ubc29\uc2dd\uc758 \uc7a0\uc7ac\ub825\uc744 \uc815\ud655\ud788 \ud30c\uc545\ud55c \ub17c\ubb38."}),"\n",(0,n.jsx)(e.p,{children:"\ub450 \ubc88\uc9f8\ub85c \ud574\ub2f9 \ub17c\ubb38\uc740 \ub525 \ub7ec\ub2dd MOE \ubaa8\ub378 \ud559\uc2b5\uc5d0 \ud544\uc5f0\uc801\uc73c\ub85c \ub530\ub77c\uc624\ub294 \ub450 \uac00\uc9c0 \uc911\uc694\ud55c \ubb38\uc81c\uc810\uc744 \uc9c0\uc801\ud558\uace0, \uc774\ub97c loss function \uc744 \ud65c\uc6a9\ud55c"}),"\n",(0,n.jsx)(e.h2,{id:"structure",children:"Structure"}),"\n",(0,n.jsx)(e.p,{children:"\uad6c\uc870\ub294 \ub9e4\uc6b0 \ub2e8\uc21c\ud558\ub2e4. \ubcf4\ub2e4 \uc77c\ubc18\uc801\uc73c\ub85c \uc124\uba85\ud558\ub824\ud55c\ub2e4."}),"\n",(0,n.jsx)(e.p,{children:"\uae30\uc874\uc758 MOE \ubaa8\ub378\ub4e4\uc774 \ubaa8\ub378 \uc790\uccb4\ub97c expert \ub85c \ud559\uc2b5\ud55c \uac83\uacfc \ub2e4\ub974\uac8c, \ubcf8 \ub17c\ubb38\uc740 \ubaa8\ub378 \uad6c\uc870 \uc911 \uc77c\ubd80\ub97c expert \ub85c \ud559\uc2b5\ud55c\ub2e4. expert \uad6c\uc870 \uc774\uc804\uc5d0\ub294 input \uc774 \uc5b4\ub5a4 expert \ub97c \uc0ac\uc6a9\ud560\uc9c0 \uacb0\uc815\ud558\ub294 gating network \ud568\uc218\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4. \uc804\uccb4 \ubaa8\ub378\uc774 \ubc18\ubcf5\ud574\uc11c \uc0ac\uc6a9\ud558\ub294 \ubaa8\ub4c8\uc758 \uc77c\ubd80\ub97c MOE \uad6c\uc870\ub85c \ubcc0\uacbd\ud55c\ub2e4. \ubaa8\ub4c8\uc744 \ubc18\ubcf5\uc801\uc73c\ub85c \uc0ac\uc6a9\ud558\ub294 \ubaa8\ub378\uc740 1) gating network \ub85c \uc778\ud55c expert \uc120\ud0dd\uc758 \ub2e4\uc591\uc131, 2) \uac01 \ubaa8\ub4c8\uc758 expert \uc120\ud0dd \uc870\ud569\uc5d0 \uc758\ud55c \ub2e4\uc591\uc131, \ub450 \uac00\uc9c0 \ub2e4\uc591\uc131\uc5d0 \uc758\ud574 \ub9e4\uc6b0 \ub9ce\uc740 \uacbd\uc6b0\uc758 \uc218\ub97c \ub300\uc751\ud560 \uc218 \uc788\uac8c \ub41c\ub2e4."}),"\n",(0,n.jsx)(e.p,{children:"\ud574\ub2f9 \ub17c\ubb38\uc740 17\ub144\ub3c4 \ub17c\ubb38\uc778 \ub9cc\ud07c, LSTM \uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4. \uc774\ub85c \uc778\ud574 \uac01 cell \uc740 \uac70\uc758 \uc804\uccb4\uac00 'Expert' \ub85c \ud65c\uc6a9\ub41c\ub2e4. \ubaa8\ub378 \uad6c\uc870\uc758 \uadf9\ud788 \uc77c\ubd80 - FFN - \uc774 expert \ub85c \ubd84\uae30\ub418\ub294 \uac83\uc740 \uc774\ubcf4\ub2e4 \uba87 \ub10c\uc740 \ub4a4\uc758 \uc5f0\uad6c..."}),"\n",(0,n.jsx)("div",{style:{textAlign:"Center"},children:(0,n.jsx)("img",{src:t,style:{border:"solid",width:600}})}),"\n",(0,n.jsxs)(e.p,{children:["LSTM \uc758 cell \uc774 expert \uac00 \ub418\ubbc0\ub85c \ud574\uc11d\uc740 \ub2e8\uc21c\ud574\uc9c4\ub2e4. \uac01\uac01\uc758 word, \ub610\ub294 token \uc774 cell \uc5d0 \uc785\ub825\uc774 \ub420\ub54c\ub9c8\ub2e4 gating network \ub97c \ud1b5\uacfc\ud558\uace0 \uc774\uc5d0 \ub530\ub978 expert cell network \ub97c \ud1b5\uacfc\ud55c\ub2e4. \ub2e4\uc74c timestep \uc740 \ud574\ub2f9 \uacb0\uacfc\uc640 \ud604\uc7ac token \uc744 \ubc1b\uc544 \uac19\uc740 \uacfc\uc815\uc744 \ubc18\ubcf5\ud55c\ub2e4. \ud575\uc2ec\uc740, ",(0,n.jsx)(e.strong,{children:"\uac01\uac01\uc758 token \ub610\ub294 time \uc5d0 \ub530\ub77c expert \uac00 \uc815\ud574\uc9c4\ub2e4\ub294 \uc810"}),"\uc774\ub2e4."]}),"\n",(0,n.jsx)(e.h2,{id:"gating-networks",children:"Gating Networks"}),"\n",(0,n.jsx)(e.p,{children:"MOE \ubc29\uc2dd\uc5d0\uc11c\ub294 \uc120\ud0dd\uacfc \uc9d1\uc911\uc774 \uc911\uc694\ud569\ub2c8\ub2e4. MOE \ubc29\uc2dd\uc744 \uc120\ud0dd\ud55c \uc774\uc720\ub3c4, \uae30\ub300\ud558\ub294 \uacb0\uacfc\ub3c4 \ubaa8\ub450 input \uc5d0 \ub300\uc751\ud558\ub294, \uc804\ubb38\uc801\uc778 expert \uac00 \ud559\uc2b5\ub418\uae30\ub97c \ubc14\ub77c\uae30 \ub584\ubb38\uc774\ub2e4. \ub2e4\ub978 expert \uac00 \ud559\uc2b5\uc5d0 \uad00\uc5ec\ud558\ub294 \uac83\ub3c4, loss \uac00 \ub2e4\ub978 expert \ub85c \ud37c\uc838\ub098\uac00\ub294 \uac83\ub3c4 \uc6d0\ud558\ub294 \ubc29\ud5a5\uc774 \uc544\ub2c8\ub2e4."}),"\n",(0,n.jsx)(e.p,{children:"Gating Networks \ub97c \uc124\uba85\ud558\uba74 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4. Softmax \ud568\uc218 \uacb0\uacfc top-K \ub9cc\uc744 expert \ub85c \uc0ac\uc6a9\ud55c\ub2e4."}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"G"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mtext,{children:"Softmax"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mtext,{children:"KeepTopK"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"H"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{separator:"true",children:","}),(0,n.jsx)(e.mi,{children:"k"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"G(x) = \\text{Softmax}(\\text{KeepTopK}(H(x), k))"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"G"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Softmax"})}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"KeepTopK"})}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mpunct",children:","}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,n.jsx)(e.span,{className:"mclose",children:"))"})]})]})]})}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:"H"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mi,{children:"i"})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsx)(e.mo,{children:"\u22c5"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"W"}),(0,n.jsx)(e.mi,{children:"g"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mi,{children:"i"})]}),(0,n.jsx)(e.mo,{children:"+"}),(0,n.jsx)(e.mtext,{children:"StandardNormal"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mo,{children:"\u22c5"}),(0,n.jsx)(e.mtext,{children:"Softplus"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"x"}),(0,n.jsx)(e.mo,{children:"\u22c5"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"W"}),(0,n.jsx)(e.mtext,{children:"noise"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mi,{children:"i"})]}),(0,n.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"H(x)_i = (x \\cdot W_g)_i + \\text{StandardNormal}() \\cdot \\text{Softplus}((x \\cdot W_{\\text{noise}})_i)"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.08125em"},children:"H"}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsxs)(e.span,{className:"mclose",children:[(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1.0361em",verticalAlign:"-0.2861em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"W"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"g"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsxs)(e.span,{className:"mclose",children:[(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"+"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"StandardNormal"})}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"Softplus"})}),(0,n.jsx)(e.span,{className:"mopen",children:"(("}),(0,n.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"W"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3175em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:(0,n.jsx)(e.span,{className:"mord text mtight",children:(0,n.jsx)(e.span,{className:"mord mtight",children:"noise"})})})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsxs)(e.span,{className:"mclose",children:[(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,n.jsx)(e.span,{className:"katex-display",children:(0,n.jsxs)(e.span,{className:"katex",children:[(0,n.jsx)(e.span,{className:"katex-mathml",children:(0,n.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"KeepTopK"}),(0,n.jsx)(e.mo,{stretchy:"false",children:"("}),(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mo,{separator:"true",children:","}),(0,n.jsx)(e.mi,{children:"k"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mo,{stretchy:"false",children:")"}),(0,n.jsx)(e.mi,{children:"i"})]}),(0,n.jsx)(e.mo,{children:"="}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{fence:"true",children:"{"}),(0,n.jsxs)(e.mtable,{rowspacing:"0.36em",columnalign:"left left",columnspacing:"1em",children:[(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mi,{children:"i"})]}),(0,n.jsx)(e.mo,{separator:"true",children:","})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:"if\xa0"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mi,{children:"i"})]}),(0,n.jsx)(e.mtext,{children:"\xa0is\xa0in\xa0the\xa0top\xa0"}),(0,n.jsx)(e.mi,{children:"k"}),(0,n.jsx)(e.mtext,{children:"\xa0elements\xa0of\xa0"}),(0,n.jsx)(e.mi,{children:"v"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"."})]})})})]}),(0,n.jsxs)(e.mtr,{children:[(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:"\u2212"}),(0,n.jsx)(e.mi,{mathvariant:"normal",children:"\u221e"}),(0,n.jsx)(e.mo,{separator:"true",children:","})]})})}),(0,n.jsx)(e.mtd,{children:(0,n.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,n.jsx)(e.mtext,{children:"otherwise."})})})]})]})]})]}),(0,n.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{KeepTopK}(v, k)_i =\n\\begin{cases} \n    v_i, & \\text{if } v_i \\text{ is in the top } k \\text{ elements of } v. \\\\\n    -\\infty, & \\text{otherwise.}\n\\end{cases}"})]})})}),(0,n.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"KeepTopK"})}),(0,n.jsx)(e.span,{className:"mopen",children:"("}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"mpunct",children:","}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,n.jsxs)(e.span,{className:"mclose",children:[(0,n.jsx)(e.span,{className:"mclose",children:")"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.jsx)(e.span,{className:"mrel",children:"="}),(0,n.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,n.jsxs)(e.span,{className:"base",children:[(0,n.jsx)(e.span,{className:"strut",style:{height:"3em",verticalAlign:"-1.25em"}}),(0,n.jsxs)(e.span,{className:"minner",children:[(0,n.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,n.jsx)(e.span,{className:"delimsizing size4",children:"{"})}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsxs)(e.span,{className:"mtable",children:[(0,n.jsx)(e.span,{className:"col-align-l",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.69em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3.69em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mpunct",children:","})]})]}),(0,n.jsxs)(e.span,{style:{top:"-2.25em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord",children:"\u2212"}),(0,n.jsx)(e.span,{className:"mord",children:"\u221e"}),(0,n.jsx)(e.span,{className:"mpunct",children:","})]})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"1.19em"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:"arraycolsep",style:{width:"1em"}}),(0,n.jsx)(e.span,{className:"col-align-l",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsxs)(e.span,{className:"vlist",style:{height:"1.69em"},children:[(0,n.jsxs)(e.span,{style:{top:"-3.69em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"if\xa0"})}),(0,n.jsxs)(e.span,{className:"mord",children:[(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"msupsub",children:(0,n.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,n.jsxs)(e.span,{className:"vlist-r",children:[(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,n.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,n.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,n.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"\xa0is\xa0in\xa0the\xa0top\xa0"})}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"\xa0elements\xa0of\xa0"})}),(0,n.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,n.jsx)(e.span,{className:"mord",children:"."})]})]}),(0,n.jsxs)(e.span,{style:{top:"-2.25em"},children:[(0,n.jsx)(e.span,{className:"pstrut",style:{height:"3.008em"}}),(0,n.jsx)(e.span,{className:"mord",children:(0,n.jsx)(e.span,{className:"mord text",children:(0,n.jsx)(e.span,{className:"mord",children:"otherwise."})})})]})]}),(0,n.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,n.jsx)(e.span,{className:"vlist-r",children:(0,n.jsx)(e.span,{className:"vlist",style:{height:"1.19em"},children:(0,n.jsx)(e.span,{})})})]})})]})}),(0,n.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,n.jsx)(e.h2,{id:"engineering",children:"Engineering"}),"\n",(0,n.jsx)(e.p,{children:"\ud574\ub2f9 \ub17c\ubb38\uc5d0\uc11c \uc81c\uc548\ud558\ub294 MOE \uad6c\ud604\uc5d0\uc11c\uc758 \uac00\uc7a5 \ud070 challenge \ub294 \ub450 \uac00\uc9c0\uc774\ub2e4."}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["batch size","\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"expert \uac1c\uc218\uac00 \ub298\uc5b4\ub0a0\uc218\ub85d \uac01\uac01\uc758 expert \uac00 \ud559\uc2b5\uc5d0 \uc0ac\uc6a9\ud558\ub294 \uc2e4\uc9c8\uc801\uc778 \ub370\uc774\ud130\uc758 \uc218\uac00 \ube44\ub840\ud574\uc11c \uac10\uc18c\ud55c\ub2e4. \uc774\ub294 \ud559\uc2b5 \ud6a8\uc728 \uac10\uc18c\ub85c \uc774\uc5b4\uc9c4\ub2e4"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["expert collapsing","\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"gating network \uac00 \uc77c\ubd80 \ub124\ud2b8\uc6cc\ud06c\ub9cc \uc120\ud0dd\ud558\ub3c4\ub85d \ud559\uc2b5\ub420 \uc218 \uc788\ub2e4."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(e.p,{children:"\ubcf8 \ub17c\ubb38\uc740 \ub450 \ubb38\uc81c\uc758 \ud574\uacb0\ucc45\uc744 \uc81c\uc2dc\ud55c\ub2e4. \ud2b9\ud788 expert collapsing \uc758 \uacbd\uc6b0 \ud574\ub2f9 \ub17c\ubb38\uc5d0\uc11c \uc81c\uc548\ud55c \ud574\uacb0\ucc45\uc774 \uc788\ub2e4. \ucc3d\uc758\uc131\uc774 \ub3c5\ubcf5\uc774\ub294 \ud574\uacb0\ubc95\uc774\uc9c0\ub9cc, \ucd5c\uadfc\uc5d0 \uc640\uc11c\ub294 \uc804\uc81c\uc5d0 \ub9de\uc9c0 \uc54a\ub294 \ud574\uacb0\ubc95\uc774 \ub418\uc5c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4, \ud604\ub300 deep learning \ubaa8\ub378\uc740 descrete \uc9c0\ud45c\ub97c loss \uc5d0 \uc27d\uac8c \ubc18\uc601\ud55c\ub2e4."}),"\n",(0,n.jsx)(e.h1,{id:"ref",children:"Ref"}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:"https://arxiv.org/pdf/1701.06538",children:"https://arxiv.org/pdf/1701.06538"})}),"\n"]})]})}function d(s={}){const{wrapper:e}={...(0,i.R)(),...s.components};return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(x,{...s})}):x(s)}},8453:(s,e,a)=>{a.d(e,{R:()=>t,x:()=>r});var l=a(6540);const n={},i=l.createContext(n);function t(s){const e=l.useContext(i);return l.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(n):s.components||n:t(s.components),l.createElement(i.Provider,{value:e},s.children)}}}]);